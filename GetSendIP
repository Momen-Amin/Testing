#!/bin/bash

# ==============================
#   Server IP Reporter Script
# ==============================

# Server info
HOSTNAME=$(hostname)
DATE=$(date +"%Y-%m-%d %H:%M:%S")

# Retrieve the Public IP address
public_ip_address=$(curl -s https://api.ipify.org)

# Retrieve ALL private IPs with their interface names
# Format: "eth0: 192.168.1.10"
private_ips=$(ip -o -4 addr show | awk '{print $2": "$4}' | sed 's/\/.*//')

# Prepare terminal output
echo
echo "=============================="
echo " Server IP Information"
echo "=============================="
echo "Hostname: $HOSTNAME"
echo "Date: $DATE"
echo
echo "Public IP: $public_ip_address"
echo
echo "Private IPs (with interfaces):"
echo "$private_ips"
echo "=============================="
echo

# Email configuration
recipient="momen.amin@hotmail.com"
subject="[$HOSTNAME] Server IP Report"

# Email body
email_body="Server Hostname: ${HOSTNAME}
Date: ${DATE}

Public IP Address:
${public_ip_address}

Private IP Addresses (with interface names):
${private_ips}
"

# Send the email
echo -e "$email_body" | mail -s "$subject" "$recipient"
