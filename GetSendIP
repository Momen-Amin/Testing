#!/bin/bash

# ==============================
#   Server IP Reporter Script
# ==============================

HOSTNAME=$(hostname)
DATE=$(date +"%Y-%m-%d %H:%M:%S")

# Public IP
public_ip_address=$(curl -s https://api.ipify.org)

# Collect all interface names + IPv4 addresses
private_ips=""
for iface in $(ls /sys/class/net/); do
    ip_addr=$(ip -4 addr show "$iface" | grep -oP '(?<=inet\s)\d+(\.\d+){3}')
    if [[ -n "$ip_addr" ]]; then
        private_ips+="$iface: $ip_addr"$'\n'
    fi
done

# Terminal output
echo
echo "=============================="
echo " Server IP Information"
echo "=============================="
echo "Hostname: $HOSTNAME"
echo "Date: $DATE"
echo
echo "Public IP: $public_ip_address"
echo
echo "Private IPs (with interfaces):"
echo "$private_ips"
echo "=============================="
echo

# Email settings
recipient="momen.amin@hotmail.com"
subject="[$HOSTNAME] Server IP Report"

# Email body
email_body="Server Hostname: ${HOSTNAME}
Date: ${DATE}

Public IP Address:
${public_ip_address}

Private IP Addresses (with interface names):
${private_ips}
"

echo -e "$email_body" | mail -s "$subject" "$recipient"
